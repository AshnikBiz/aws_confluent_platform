# Change values for dbserver, broker1, broker2, broker3, kafka-connect hosts accordingly

#####################
Kafka Connect Plugins
#####################
curl -X GET -k https://kafka-connect:8083/connector-plugins | jq .

################################
# Upload Kafaka Connector Config
################################
curl -X PUT -k -H "Content-Type: application/json" --data '{
  "name": "jdbc-src-oracle-emp-bulk",
  "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
  "connection.url": "jdbc:oracle:thin:@dbserver:1521/XE",
  "connection.user": "orcl_user",
  "connection.password": "Password",
  "table.whitelist": "ORCL_USER.EMPLOYEES",
  "numeric.mapping": "best_fit",
  "mode": "bulk",
  "table.types": "TABLE",
  "poll.interval.ms": "86400000"
}' https://kafka-connect:8083/connectors/jdbc-src-orcl-emp-bulk/config | jq .


curl -X GET -k https://kafka-connect:8083/connectors | jq .
curl -X GET -k https://kafka-connect:8083/connectors/jdbc-src-oracle-emp-bulk/status | jq .

#######################
# Sample Configurations
#######################

# Connector: JdbcSourceConnector; Source: Oracle
# Scenario: Bulk Load Single Table (EMPLOYEES) to Kafka Topic (EMPLOYEES); Poll after 24 hours;
{
  "name": "jdbc-src-orcl-emp-bulk",
  "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
  "connection.url": "jdbc:oracle:thin:@dbserver:1521/XE",
  "connection.user": "orcl_user",
  "connection.password": "Password",
  "table.whitelist": [
    "ORCL_USER.EMPLOYEES"
  ],
  "numeric.mapping": "best_fit",
  "mode": "bulk",
  "table.types": [
    "TABLE"
  ],
  "poll.interval.ms": "86400000"
}


# Connector: JdbcSinkConnector; Target: Oracle
# Scenario: Insert from Kafka Topic (EMPLOYEES) to existing Table (EMPLOYEES);
{
  "name": "oracle-jdbc-tgt",
  "connector.class": "io.confluent.connect.jdbc.JdbcSinkConnector",
  "topics": [
    "EMPLOYEES"
  ],
  "connection.url": "jdbc:oracle:thin:@dbserver:1525/XE",
  "connection.user": "orcl_user",
  "connection.password": "Password",
  "insert.mode": "insert",
  "table.types": [
    "TABLE"
  ],
  "table.name.format": "EMPLOYEES"
}


# Connector: JdbcSinkConnector; Target: Postgres
# Scenario: Insert from Kafka Topic (EMPLOYEES) to Table (employees); Create DDL;
{
  "name": "jdbc-sink-postgres-emp-insert",
  "connector.class": "io.confluent.connect.jdbc.JdbcSinkConnector",
  "topics": [
    "EMPLOYEES"
  ],
  "connection.url": "jdbc:postgresql://dbserver:5432/postgres",
  "connection.user": "postgres",
  "connection.password": "Password",
  "insert.mode": "insert",
  "table.name.format": "employees",
  "auto.create": "true"
}


# Connector: MySqlConnector; Source: MySQL
# Scenario: CDC All Tables in Schema (sales) to Kafka Topics (sales_sales_<table_name>);
{
  "name": "debezium-mysql-src-mysql-sales-cdc",
  "connector.class": "io.debezium.connector.mysql.MySqlConnector",
  "database.hostname": "dbserver",
  "database.port": "3306",
  "database.user": "root",
  "database.password": "Password",
  "database.server.name": "sales",
  "database.history.kafka.bootstrap.servers": "broker1:9092,broker2:9092,broker3:9092",
  "database.history.kafka.topic": "dbhistory.sales",
  "include.schema.changes": false,
  "database.include.list": [
    "sales"
  ],
  "database.history.producer.sasl.jaas.config": "org.apache.kafka.common.security.plain.PlainLoginModule required username=\"kafka_connect\" password=${securepass:/var/ssl/private/security.properties:connect-distributed.properties/producer.sasl.jaas.config/org.apache.kafka.common.security.plain.PlainLoginModule/password};",
  "database.history.producer.sasl.mechanism": "PLAIN",
  "database.history.producer.security.protocol": "SASL_SSL",
  "database.history.producer.ssl.keystore.location": "/var/ssl/private/kafka_connect.keystore.jks",
  "database.history.producer.ssl.keystore.password": "${securepass:/var/ssl/private/security.properties:connect-distributed.properties/producer.ssl.keystore.password}",
  "database.history.producer.ssl.truststore.location": "/var/ssl/private/kafka_connect.truststore.jks",
  "database.history.producer.ssl.truststore.password": "${securepass:/var/ssl/private/security.properties:connect-distributed.properties/producer.ssl.truststore.password}",
  "database.history.producer.ssl.key.password": "${securepass:/var/ssl/private/security.properties:connect-distributed.properties/producer.ssl.key.password}",
  "database.history.consumer.sasl.jaas.config": "org.apache.kafka.common.security.plain.PlainLoginModule required username=\"kafka_connect\" password=${securepass:/var/ssl/private/security.properties:connect-distributed.properties/consumer.sasl.jaas.config/org.apache.kafka.common.security.plain.PlainLoginModule/password};",
  "database.history.consumer.sasl.mechanism": "PLAIN",
  "database.history.consumer.security.protocol": "SASL_SSL",
  "database.history.consumer.ssl.keystore.location": "/var/ssl/private/kafka_connect.keystore.jks",
  "database.history.consumer.ssl.keystore.password": "${securepass:/var/ssl/private/security.properties:connect-distributed.properties/consumer.ssl.keystore.password}",
  "database.history.consumer.ssl.truststore.location": "/var/ssl/private/kafka_connect.truststore.jks",
  "database.history.consumer.ssl.truststore.password": "${securepass:/var/ssl/private/security.properties:connect-distributed.properties/consumer.ssl.truststore.password}",
  "database.history.consumer.ssl.key.password": "${securepass:/var/ssl/private/security.properties:connect-distributed.properties/consumer.ssl.key.password}",
  "transforms": "RemoveDots",
  "transforms.RemoveDots.type": "org.apache.kafka.connect.transforms.RegexRouter",
  "transforms.RemoveDots.regex": "(.*)\\.(.*)\\.(.*)",
  "transforms.RemoveDots.replacement": "$1_$2_$3"
}


# Connector: JdbcSourceConnector; Source: MySQL
# Scenario: Incremental Load Single Table (CUSTOMER) to Kafka Topic (CUSTOMER); Poll after 5 minutes;
{
  "name": "jdbc-src-mysql-cust-incr",
  "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
  "connection.url": "jdbc:mysql://dbserver:3306/sales",
  "connection.user": "root",
  "connection.password": "Password",
  "table.whitelist": [
    "CUSTOMER"
  ],
  "mode": "incrementing",
  "incrementing.column.name": "id",
  "table.types": [
    "TABLE"
  ],
  "poll.interval.ms": "300000"
}


# Connector: MongoSinkConnector; Target: MongoDB
# Scenario: Insert from Kafka Topic (sales_sales_product) to Collection (products);
{
  "name": "mongo-sink-mongo-prod-insert",
  "connector.class": "com.mongodb.kafka.connect.MongoSinkConnector",
  "topics": [
    "sales_sales_product"
  ],
  "connection.uri": "mongodb://root:Password@dbserver:27017",
  "database": "admin",
  "collection": "products"
}


# Connector: ElasticsearchSinkConnector; Target: Elasticsearch
# Scenario: Insert/Update from Kafka Topic (sales_sales_product) to Index (products);
{
  "name": "elastic-sink-elastic-prod-upsert",
  "connector.class": "io.confluent.connect.elasticsearch.ElasticsearchSinkConnector",
  "transforms": [
    "dropPrefix"
  ],
  "topics": [
    "sales_sales_product"
  ],
  "connection.url": [
    "http://dbserver:9200"
  ],
  "connection.username": "elastic",
  "connection.password": "Password",
  "write.method": "UPSERT",
  "key.ignore": "true",
  "schema.ignore":"true",
  "transforms.dropPrefix.type":"org.apache.kafka.connect.transforms.RegexRouter",
  "transforms.dropPrefix.regex":"sales_sales_(.*)",
  "transforms.dropPrefix.replacement":"$1"
}


# Connector: OracleCdcSourceConnector; Source: Oracle
# Scenario: CDC Single Tables (EMPLOYEES) to Kafka Topics (XE_ORCL_USER_EMPLOYEES);
{
  "name": "oracle-src-orcl-emp-cdc",
  "connector.class": "io.confluent.connect.oracle.cdc.OracleCdcSourceConnector",
  "oracle.server": "dbserver",
  "oracle.port": "1520",
  "oracle.sid": "XE",
  "oracle.username": "orcl_user",
  "oracle.password": "Password",
  "numeric.mapping": "best_fit",
  "table.inclusion.regex": "XE[.]ORCL_USER[.](EMPLOYEES)"
}


# Connector: JdbcSinkConnector; Target: Oracle
# Scenario: Insert from Kafka Topic (XE.ORCL_USER.EMPLOYEES) to existing Table (EMPLOYEES1);
{
  "name": "jdbc-sink-orcl-emp-cdc-insert",
  "connector.class": "io.confluent.connect.jdbc.JdbcSinkConnector",
  "topics": [
    "XE.ORCL_USER.EMPLOYEES"
  ],
  "connection.url": "jdbc:oracle:thin:@dbserver:1525/XEPDB1",
  "connection.user": "orcl_user",
  "connection.password": "Password",
  "insert.mode": "insert",
  "table.types": [
    "TABLE"
  ],
  "table.name.format": "ORCL_USER.EMPLOYEES1",
  "pk.mode": "none",
  "fields.whitelist": [
    "EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION_PCT,MANAGER_ID,DEPARTMENT_ID"
  ],
  "auto.create": "false"
}
